// ------------------------------------------------------------------------------
//  <auto-generated>
//     This code was generated from a template.
// 
//     Manual changes to this file will be overwritten if the code is regenerated.
//
//     Generated on 2018-02-16T11:17:32, by ESR Version 1.71.0.0 using ESR Database 
//  </auto-generated>
// ------------------------------------------------------------------------------

using System;
using System.Xml;
using System.IO;
using System.Collections.Generic;
using DataContracts;
using System.Text.RegularExpressions;
using System.Reflection;
using System.Linq;
using System.Xml.Schema;
using System.Text;


namespace Ato.EN.IntegrationServices.CodeGenerationPAYEVNTEMP
{
    /// <summary>
    /// XML Consumer for PAYEVNTEMP
    /// </summary>
    public class PAYEVNTEMP2018XmlConsumer
    {
        const string MissingMandatoryMessage = "A mandatory field has not been completed.";
        const string ContactYourProviderMsg = "The message did not pass XML validation. Please contact your software provider.";
        const string InvalidDataValidation = "A field contains invalid data (such as letters in numeric or date field).";
        private const string ErrorCode1 = "CMN.ATO.GEN.XML01";
        private const string ErrorCode3 = "CMN.ATO.GEN.XML03";
        private const string ErrorCode4 = "CMN.ATO.GEN.XML04";
        private const string ErrorCode6 = "CMN.ATO.GEN.XML06";
        private bool _found = false;
        private int _parentCollectionCount;
        private int _childCollectionCount;
        private bool _isExiting = false;
        private bool _isValidationError = false;
        private string _lastPath = string.Empty;
        private ErrorMessageType _validationError = new ErrorMessageType(ErrorDescriptor.NoError);


        #region Error Messages

        public List<ProcessMessageDocument> ErrorMessages { get; set; }

        public bool HasErrors
        {
            get
            {
                return ErrorMessages != null && ErrorMessages.Count > 0;
            }
        }

        private string GetCurrentLocation()
        {
            StringBuilder location = new StringBuilder();
            string[] paths = _currentXPath.ToArray<string>();
            for (int i = paths.Length - 1; i > -1; i--)
            {
                location.Append(paths[i]);
            }
            return location.ToString();
        }

        private void MissingElementError()
        {
            ProcessMessageDocument processMessage;
            processMessage = new ProcessMessageDocument()
            {
                Code = "CMN.ATO.GEN.XML04",
                Description = MissingMandatoryMessage,
                SeverityAsString = "Error",
                Location = GetCurrentLocation(),
            };
            this.ErrorMessages.Add(processMessage);
        }

        #endregion  Error Messages

        #region Embedded Schema

        private static readonly XmlSchemaSet EmbeddedXmlSchemaSet;
        static PAYEVNTEMP2018XmlConsumer()
        {
            Assembly executingAssembly = Assembly.GetExecutingAssembly();
            string[] manifestResourceNames = executingAssembly.GetManifestResourceNames();
            string resourceName;
            Stream embeddedSchemaStream;
            XmlSchema embeddedXmlSchema;

            if (manifestResourceNames != null)
            {
                resourceName = manifestResourceNames.FirstOrDefault(rn => rn.Contains("ato.payevntemp.0003.2018.01.00.xsd") && rn.EndsWith(".xsd"));
                if (resourceName != null)
                {
                    embeddedSchemaStream = executingAssembly.GetManifestResourceStream(resourceName);
                    embeddedXmlSchema = XmlSchema.Read(embeddedSchemaStream, SchemaCallback);
                    EmbeddedXmlSchemaSet = new XmlSchemaSet();
                    EmbeddedXmlSchemaSet.Add(embeddedXmlSchema);
                    EmbeddedXmlSchemaSet.Compile();
                }
            }

        }

        private static void SchemaCallback(object sender, ValidationEventArgs args)
        {
            if (args.Severity == XmlSeverityType.Error)
                throw new XmlSchemaException(args.Message);
        }

        #endregion  Embedded Schema

        #region Xml Reader Settings

        private static XmlReaderSettings ReaderSettings = new XmlReaderSettings()
        {
            CloseInput = false,
            ConformanceLevel = ConformanceLevel.Fragment,
            IgnoreWhitespace = true,
            IgnoreComments = true,
            IgnoreProcessingInstructions = true,
        };

        private XmlReaderSettings GetValidatingReaderSettings()
        {
            XmlReaderSettings validatingReaderSettings = new XmlReaderSettings()
            {
                CloseInput = false,
                ConformanceLevel = ConformanceLevel.Fragment,
                IgnoreWhitespace = true,
                IgnoreComments = true,
                IgnoreProcessingInstructions = true,
                ValidationType = ValidationType.Schema,
            };
            if (EmbeddedXmlSchemaSet == null)
            {
                throw new XmlSchemaException("Embedded Schema is Null");
            }
            else
            {
                validatingReaderSettings.Schemas.Add(EmbeddedXmlSchemaSet);
                validatingReaderSettings.ValidationEventHandler += new ValidationEventHandler(ValidationCallBack);
            }
            return validatingReaderSettings;
        }

        private static Regex DataTypeFailureExpression = new Regex("'(?<Uniqueid>.*?)' element is invalid.*value '(?<Value>.*?)' is invalid.*datatype '(?<DataType>.*?)'", RegexOptions.IgnoreCase | RegexOptions.Compiled);

        private void ValidationCallBack(object sender, ValidationEventArgs args)
        {
            var msg = args.Message;
            var msgToLower = msg.ToLower();
            var lastProcessedElement = "";
            XmlReader xmlReader = (XmlReader)sender;
            lastProcessedElement = xmlReader.Name;

            ProcessMessageDocument processMessage = null;

            if (msgToLower.Contains("invalid according to its datatype"))
            {
                Match match = DataTypeFailureExpression.Match(args.Message);

                if (match.Success && match.Groups.Count == 4)
                {
                    var inner = args.Exception.InnerException;
                    var hint = (inner != null && !string.IsNullOrEmpty(inner.Message)) ? " Hint: " + inner.Message : string.Empty;
                    processMessage = BuildProcessMessageDocument(InvalidDataValidation, string.Empty, ErrorCode3);

                    string uniqueID = match.Groups["Uniqueid"].Value;
                    string value = match.Groups["Value"].Value;
                    string dataType = match.Groups["DataType"].Value;


                    var longDescription = string.Format(@"The value specified for an item does not match the item type (value = ""{0}"", item type = {1}, uniqueID = {2})", value, dataType, uniqueID);
                    processMessage.LongDescription = longDescription + hint;
                    processMessage.Parameters = new ProcessMessageParameters();
                    processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "uniqueID", Value = uniqueID });
                    processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "value", Value = value });
                    processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "dataType", Value = dataType });
                }
            }
            else if (msgToLower.Contains("has incomplete content"))
            {
                _validationError = GetErrorDescriptorForHasIncompleteContent(msg);
                processMessage = BuildProcessMessageDocument(MissingMandatoryMessage, msg + _validationError.Hint, _validationError.Code, "tns:" + _validationError.LastElementProcessed);
                _isValidationError = true;
            }
            else if (msgToLower.Contains("has invalid child element"))
            {
                _validationError = GetErrorDescriptorForHasInvalidChildElement(msg);
                var shortMessage = _validationError.Code == ErrorCode4 ? MissingMandatoryMessage : ContactYourProviderMsg;
                processMessage = BuildProcessMessageDocument(shortMessage, msg + _validationError.Hint, _validationError.Code);
                _isValidationError = true;
            }
            else if (msgToLower.Contains("'xsi:nil' attribute must not be present"))
            {
                processMessage = BuildProcessMessageDocument(ContactYourProviderMsg, msg, ErrorCode1, lastProcessedElement);
                _isValidationError = true;
            }
            else
            {
                processMessage = BuildProcessMessageDocument(ContactYourProviderMsg, msg, ErrorCode1);
                _isValidationError = true;
            }

            this.ErrorMessages.Add(processMessage);
        }

        private ProcessMessageDocument BuildProcessMessageDocument(string shortDescription, string longDescription, string code, string lastElementProcessed)
        {
            return new ProcessMessageDocument()
            {
                Code = code,
                Description = shortDescription,
                LongDescription = longDescription,
                SeverityAsString = "Error",
                Location = lastElementProcessed
            };
        }

        private ProcessMessageDocument BuildProcessMessageDocument(string shortDescription, string longDescription, string code)
        {
            return new ProcessMessageDocument()
            {
                Code = code,
                Description = shortDescription,
                LongDescription = longDescription,
                SeverityAsString = "Error",
                Location = GetCurrentLocation()
            };
        }

        private ProcessMessageDocument BuildProcessMessageDocument(ProcessMessageDocument processMessage, string newLocation)
        {
            return new ProcessMessageDocument()
            {
                Code = processMessage.Code,
                Description = processMessage.Description,
                LongDescription = processMessage.LongDescription,
                SeverityAsString = "Error",
                Location = newLocation
            };
        }

        private enum ErrorDescriptor
        {
            NoError = 0,
            MandatoryElementError,
            NonMandatoryElementError,
            UnknownElement,
            Duplicate
        }

        private struct ErrorMessageType
        {
            public string Hint, Code, ExpectedNextValidElement, LastElementProcessed;
            public ErrorDescriptor Errno;

            public ErrorMessageType(ErrorDescriptor errorDescriptor)
            {
                Errno = errorDescriptor;
                Hint = "";
                Code = "";
                ExpectedNextValidElement = "";
                LastElementProcessed = "";
            }

            public ErrorMessageType(ErrorDescriptor errorDescriptor, string hint, string code, string elementName, string lastElementProcessed)
            {
                Errno = errorDescriptor;
                Hint = hint;
                Code = code;
                ExpectedNextValidElement = elementName;
                LastElementProcessed = lastElementProcessed;
            }
        }

        private ErrorMessageType GetErrorDescriptorForHasIncompleteContent(string validationErrorMessage)
        {
            ErrorMessageType retval = new ErrorMessageType();
            if (string.IsNullOrWhiteSpace(validationErrorMessage)) return retval;

            validationErrorMessage = validationErrorMessage.Replace(" ", string.Empty);
            validationErrorMessage = validationErrorMessage.Replace("'", " ");
            var parts = validationErrorMessage.Split(' ');
            if (parts.Length != 9) return retval;

            var elementBeingProcessed = parts[1];
            var csvList = parts[5];

            retval = ParseHasIncompleteContentCVSList(csvList, elementBeingProcessed);
            return retval;
        }

        private ErrorMessageType GetErrorDescriptorForHasInvalidChildElement(string validationErrorMessage)
        {
            string msg = string.Empty;
            ErrorMessageType retval = new ErrorMessageType();
            if (string.IsNullOrWhiteSpace(validationErrorMessage)) return retval;

            validationErrorMessage = validationErrorMessage.Replace(" ", string.Empty);
            validationErrorMessage = validationErrorMessage.Replace("'", " ");
            var parts = validationErrorMessage.Split(' ');

            //decide which message format to process
            if (validationErrorMessage.ToLower().Contains("listofpossibleelements"))
            {
                if (parts.Length != 13) return retval;
                var csvList = parts[9];
                var elementBeingProcessed = parts[1];
                var invalidChildElementName = parts[5];
                retval = ParseCvsListForHasInvalidChildElementLongFormat(csvList, invalidChildElementName, elementBeingProcessed);
            }
            else
            {
                if (parts.Length != 9) return retval;
                var csvList = parts[5];
                var elementBeingProcessed = parts[1];
                var invalidChildElementName = parts[5];

                retval = ParseCvsListForHasInvalidChildElementLongFormat(csvList, invalidChildElementName, elementBeingProcessed);
            }
            return retval;
        }

        private ErrorMessageType ParseCvsListForHasInvalidChildElementShortFormat(string csvList, string invalidChildElementName, string elementBeingProcessed)
        {
            ErrorMessageType retval = new ErrorMessageType();

            if (!string.IsNullOrEmpty(csvList))
            {
                var lastElementInListOfPossibleElements = GetLastElementInCsvList(csvList);
                var elementList = new List<string>(_elementCsvList.Split(','));

                retval.Hint =
                    string.Format(
                        " Hint: while processing parent element [{0}] child element [{1}] was unexpected",
                        elementBeingProcessed, invalidChildElementName);
                retval.Code = ErrorCode1;
                retval.Errno = ErrorDescriptor.UnknownElement;
                retval.ExpectedNextValidElement = invalidChildElementName;
                retval.LastElementProcessed = elementBeingProcessed;
            }

            return retval;
        }

        private string GetLastElementInCsvList(string csvList)
        {
            var list = (csvList.Contains(','))
                ? new List<string>(csvList.Split(','))
                : new List<string> { csvList };
            return list.Last();
        }

        private ErrorMessageType ParseCvsListForHasInvalidChildElementLongFormat(string csvList, string invalidChildElementName, string elementBeingProcessed)
        {
            ErrorMessageType retval = new ErrorMessageType();

            if (!string.IsNullOrEmpty(csvList))
            {
                var lastElementInListOfPossibleElements = GetLastElementInCsvList(csvList);
                var elementList = new List<string>(_elementCsvList.Split(','));

                if (elementList.Contains(invalidChildElementName))
                {
                    //this is an invalid child element now determine if its a mandatory or optional element.
                    var indexOfElementBeingProcessed = elementList.IndexOf(elementBeingProcessed);
                    var indexOfinvalidChildElementName = elementList.IndexOf(invalidChildElementName);
                    var indexOflastElementInListOfPossibleElements =
                        elementList.IndexOf(lastElementInListOfPossibleElements);
                    if (indexOfinvalidChildElementName > indexOflastElementInListOfPossibleElements)
                    {
                        retval.Hint =
                            string.Format(
                                " Hint: while processing parent element [{0}] child mandatory element [{1}] was expected but not found",
                                elementBeingProcessed, lastElementInListOfPossibleElements);
                        retval.Code = ErrorCode4;
                        retval.Errno = ErrorDescriptor.MandatoryElementError;
                        retval.ExpectedNextValidElement = lastElementInListOfPossibleElements;
                    }
                    else
                    {
                        retval.Hint =
                            string.Format(
                                " Hint: while processing parent element [{0}] child non mandatory element [{1}] was unexpected",
                                elementBeingProcessed, invalidChildElementName);
                        retval.Code = ErrorCode1;
                        retval.Errno = (indexOfinvalidChildElementName != indexOflastElementInListOfPossibleElements) ? ErrorDescriptor.NonMandatoryElementError : ErrorDescriptor.Duplicate;
                        retval.ExpectedNextValidElement = invalidChildElementName;
                    }
                }
                else
                {
                    //this element is unknown to the schema.
                    retval.Hint =
                        string.Format(
                            " Hint: while processing parent element [{0}] child element [{1}] was unexpected",
                            elementBeingProcessed, invalidChildElementName);
                    retval.Code = ErrorCode1;
                    retval.Errno = ErrorDescriptor.UnknownElement;
                    retval.ExpectedNextValidElement = invalidChildElementName;
                }
            }

            return retval;
        }

        private ErrorMessageType ParseHasIncompleteContentCVSList(string csvList, string elementBeingProcessed)
        {
            ErrorMessageType retval = new ErrorMessageType();

            if (!string.IsNullOrEmpty(csvList))
            {
                var lastElementInListOfPossibleElements = GetLastElementInCsvList(csvList);
                var elementList = new List<string>(_elementCsvList.Split(','));

                retval.Hint =
                    string.Format(
                        " Hint: while processing parent element [{0}] child mandatory element [{1}] was not found",
                        elementBeingProcessed, lastElementInListOfPossibleElements);

                retval.Code = ErrorCode4;
                retval.Errno = ErrorDescriptor.MandatoryElementError;
                retval.ExpectedNextValidElement = lastElementInListOfPossibleElements;
                retval.LastElementProcessed = elementBeingProcessed;
            }
            return retval;
        }

        private void StartEndDateError(DateTime startDate, DateTime endDate)
        {
            ProcessMessageDocument processMessage;

            string longDescription = string.Format("End date is earlier than start date (state date = {0}, end date = {1})", startDate.ToString("yyyy-MM-dd"), endDate.ToString("yyyy-MM-dd"));

            processMessage = new ProcessMessageDocument()
            {
                Code = "CMN.ATO.GEN.XML06",
                Description = "End date is earlier than start date.",
                LongDescription = longDescription,
                SeverityAsString = "Error",
                Location = GetCurrentLocation(),
            };
            processMessage.Parameters = new ProcessMessageParameters();
            processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "startDate", Value = startDate.ToString("yyyy-MM-dd") });
            processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "endDate", Value = endDate.ToString("yyyy-MM-dd") });
            this.ErrorMessages.Add(processMessage);
        }

        private void StartEndDateError(DateTime? startDate, DateTime? endDate)
        {
            ProcessMessageDocument processMessage;

            if (startDate == null || endDate == null)
                return;

            string longDescription = string.Format("End date is earlier than start date (state date = {0}, end date = {1})", startDate.Value.ToString("yyyy-MM-dd"), endDate.Value.ToString("yyyy-MM-dd"));

            processMessage = new ProcessMessageDocument()
            {
                Code = "CMN.ATO.GEN.XML06",
                Description = "End date is earlier than start date.",
                LongDescription = longDescription,
                SeverityAsString = "Error",
                Location = GetCurrentLocation(),
            };
            processMessage.Parameters = new ProcessMessageParameters();
            processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "startDate", Value = startDate.Value.ToString("yyyy-MM-dd") });
            processMessage.Parameters.Add(new ProcessMessageParameter() { Name = "endDate", Value = endDate.Value.ToString("yyyy-MM-dd") });
            this.ErrorMessages.Add(processMessage);
        }

        #endregion  Xml Reader Settings

        #region IsEmptyOrNilElement
        private static bool IsEmptyOrNilElement(XmlReader reader)
        {
            bool emptyOrNil = false;
            if (reader.IsEmptyElement)
            {
                emptyOrNil = true;
            }
            else
            {
                if (reader.HasAttributes)
                {
                    string nilValue = reader.GetAttribute("nil", "http://www.w3.org/2001/XMLSchema-instance");
                    if (nilValue != null && nilValue.ToLowerInvariant() == "true" || nilValue == "1")
                    {
                        emptyOrNil = true;
                    }
                }
            }
            return emptyOrNil;
        }
        #endregion  IsEmptyOrNilElement

        #region ToBoolean
        private bool? ToBoolean(string str)
        {
            bool returnValue;
            string value = (str ?? "").Trim();
            if (value == "0" || value == "1")
                return Convert.ToBoolean(Convert.ToInt32(value));

            if (Boolean.TryParse(value, out returnValue))
                return returnValue;
            return null;
        }
        #endregion  ToBoolean

        #region MoveToContent
        public bool MoveToContent(XmlReader reader)
        {
            try
            {
                reader.MoveToContent();
                return true;
            }
            catch (XmlException ex)
            {
                ProcessMessageDocument processMessage;
                processMessage = new ProcessMessageDocument()
                {
                    Code = "CMN.ATO.GEN.XML01",
                    Description = ContactYourProviderMsg,
                    LongDescription = ex.Message,
                    SeverityAsString = "Error",
                };
                this.ErrorMessages.Add(processMessage);
                return false;
            }
        }
        #endregion  MoveToContent

        #region ReadToNextElement


        public bool ReadToNextElement(XmlReader reader, bool isMandatory)
        {
            return ReadToNextElement(reader);
        }

        public bool ReadToNextElement(XmlReader reader)
        {
            bool retval = false;

            if ((reader.EOF && !_isValidationError) || _isExiting)
            {
                return false; //do nothing
            }

            if (!_isValidationError)
            {
                retval = SetReaderToNextElement(reader); //position the reader on the next valid element
            }

            if (_isValidationError)
            {
                //process validation errors
                var expectedNextElement = (!string.IsNullOrEmpty(_validationError.ExpectedNextValidElement)) ? _validationError.ExpectedNextValidElement : reader.LocalName;
                var actualNextValidElement = reader.LocalName;
                var location = GetCurrentLocation();

                if (_validationError.Errno == ErrorDescriptor.Duplicate)
                {
                    location = _lastPath;
                }

                var xpath = RemoveLeadingAndTrailingSlashes(location);

                var element = GetElementDescriptor(xpath);

                if (_validationError.Errno == ErrorDescriptor.UnknownElement)
                {
                    //set the xpath for elements that are not known to the schema
                    location = "/" + element.Path + "/" + element.Prefix + ":" + _validationError.ExpectedNextValidElement;
                    _isExiting = true;
                }
                else if (_validationError.Errno == ErrorDescriptor.NonMandatoryElementError)
                {
                    //set the xpath for the optional element that caused a validation
                    location = "/" + element.Path + "/" + element.Prefix + ":" + reader.LocalName;
                    _isExiting = true;
                }
                else
                {
                    //decide if we have spooled to the missing mandatory element. 
                    _isExiting = expectedNextElement == element.PathLeafNode;
                }

                if (_isExiting)
                {
                    //The location has changed since detection of the validation error - so update it.
                    UpdateErrorMessageWithLocation(location);
                }

                return false;
            }

            //Save previous path so we can detect duplicate elements
            _lastPath = GetCurrentLocation();

            return retval;
        }

        private bool ReadNext(XmlReader reader)
        {
            return !reader.EOF && reader.Read();
        }

        private void UpdateErrorMessageWithLocation(string newLocation)
        {
            var lastProcessMessage = ErrorMessages.Last();
            ErrorMessages.Remove(lastProcessMessage);
            var newProcessMessage = BuildProcessMessageDocument(lastProcessMessage, newLocation);
            ErrorMessages.Add(newProcessMessage);
        }

        private string RemoveLeadingAndTrailingSlashes(string xpath)
        {
            var xpathLength = xpath.Length;
            if (xpathLength <= 0) return string.Empty;
            var firstChar = xpath.Substring(0, 1);
            var lastChar = xpath.Substring(xpathLength - 1, 1);
            if (firstChar == "/")
            {
                xpath = xpath.Remove(0, 1);
                xpathLength--;
            }
            if (lastChar == "/")
            {
                xpath = xpath.Remove(xpathLength - 1, 1);
            }
            return xpath;
        }

        private struct ElementDescriptor
        {
            public string Prefix, PathLeafNode, Path;
            public ElementDescriptor(string prefix, string leaf, string path)
            {
                Prefix = prefix;
                PathLeafNode = leaf;
                Path = path;
            }
        }

        private ElementDescriptor GetElementDescriptor(string xpath)
        {
            var retval = new ElementDescriptor();

            var parts = xpath.Split('/');
            var numberOfParts = parts.Length;
            if (numberOfParts > 0)
            {
                var leafNode = parts[numberOfParts - 1];
                var p = leafNode.Split(':');
                numberOfParts = p.Length;
                if (numberOfParts == 1)
                {
                    retval.PathLeafNode = p[0];
                    retval.Prefix = string.Empty;
                }
                else if (numberOfParts == 2)
                {
                    retval.PathLeafNode = p[1];
                    retval.Prefix = p[0];
                }
                var leafNodeLength = leafNode.Length;
                var path = xpath.Remove(xpath.Length - leafNodeLength, leafNodeLength);
                retval.Path = RemoveLeadingAndTrailingSlashes(path);
            }
            return retval;
        }

        private bool SetReaderToNextElement(XmlReader reader)
        {
            try
            {
                if (reader.EOF || _isExiting) return false;
                if (_found)
                {
                    reader.Read();
                    _found = false;
                }
                while (!reader.EOF && reader.NodeType != XmlNodeType.Element)
                {
                    reader.Read();
                }

                return reader.NodeType == XmlNodeType.Element && !reader.EOF;

            }
            catch (XmlException ex)
            {
                ProcessMessageDocument processMessage;
                processMessage = new ProcessMessageDocument()
                {
                    Code = ErrorCode1,
                    Description = ContactYourProviderMsg,
                    LongDescription = ex.Message,
                    SeverityAsString = "Error",
                };
                this.ErrorMessages.Add(processMessage);
                return false;
            }
        }

        #endregion  ReadToNextElement

        private Stack<string> _currentXPath = new Stack<string>(10);

        public PAYEVNTEMP2018 Consume(Stream streamToLoad, bool validateDataTypes = false)
        {
            PAYEVNTEMP2018 report = new PAYEVNTEMP2018();

            // Working Variable for if can still read from the xml stream
            bool reading;

            // Working Variables for current values
            string currentValue;
            DateTime currentDateTimeValue;
            bool? currentBooleanValue;
            decimal currentDecimalValue;
            double currentDoubleValue;
            float currentFloatValue;
            sbyte currentsByteValue;
            byte currentByteValue;
            short currentShortValue;
            ushort currentuShortValue;
            uint currentuIntValue;
            int currentIntValue;
            long currentLongValue;
            ulong currentuLongValue;

            this.ErrorMessages = new List<ProcessMessageDocument>();
            _currentXPath.Push("/tns:PAYEVNTEMP");

            if (streamToLoad == null || streamToLoad.Length == 0 || !streamToLoad.CanRead)
            {
                MissingElementError();
                return report;
            }

            streamToLoad.Position = 0;
            XmlReader reader;

            if (validateDataTypes)
                reader = XmlReader.Create(streamToLoad, GetValidatingReaderSettings());
            else
                reader = XmlReader.Create(streamToLoad, ReaderSettings);

            if (!MoveToContent(reader))
                return report;

            reading = !reader.EOF;

            if (ReadToNextElement(reader) && reader.LocalName == "PAYEVNTEMP" && reader.NamespaceURI == "http://www.sbr.gov.au/ato/payevntemp")
            {
                _found = true;
                ReadToNextElement(reader);
            }
            else
            {
                MissingElementError();
                return report;
            }


            #region Payee
            _currentXPath.Push("/tns:Payee");
            //3. use case
            if (ReadToNextElement(reader, true) && reader.LocalName == "Payee")
            {
                report.PayeeCollectionExists = true;
                report.PayeeCollectionCount += 1;
                _found = true;

                #region Identifiers
                _currentXPath.Push("/tns:Identifiers");
                //3. use case
                if (ReadToNextElement(reader, true) && reader.LocalName == "Identifiers")
                {
                    report.Payee_IdentifiersCollectionExists = true;
                    report.Payee_IdentifiersCollectionCount += 1;
                    _found = true;

                    #region TaxFileNumberId
                    _currentXPath.Push("/tns:TaxFileNumberId");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "TaxFileNumberId")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP13 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion TaxFileNumberId

                    #region AustralianBusinessNumberId
                    _currentXPath.Push("/tns:AustralianBusinessNumberId");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "AustralianBusinessNumberId")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP91 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion AustralianBusinessNumberId

                    #region EmploymentPayrollNumberId
                    _currentXPath.Push("/tns:EmploymentPayrollNumberId");
                    //6. use case
                    if (ReadToNextElement(reader, true) && reader.LocalName == "EmploymentPayrollNumberId")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP11 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion EmploymentPayrollNumberId
                } // End of if Identifiers node exists

                _currentXPath.Pop();
                #endregion Identifiers

                #region PersonNameDetails
                _currentXPath.Push("/tns:PersonNameDetails");
                //3. use case
                if (ReadToNextElement(reader, true) && reader.LocalName == "PersonNameDetails")
                {
                    report.Payee_PersonNameDetailsCollectionExists = true;
                    report.Payee_PersonNameDetailsCollectionCount += 1;
                    _found = true;

                    #region FamilyNameT
                    _currentXPath.Push("/tns:FamilyNameT");
                    //6. use case
                    if (ReadToNextElement(reader, true) && reader.LocalName == "FamilyNameT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP15 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion FamilyNameT

                    #region GivenNameT
                    _currentXPath.Push("/tns:GivenNameT");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "GivenNameT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP16 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion GivenNameT

                    #region OtherGivenNameT
                    _currentXPath.Push("/tns:OtherGivenNameT");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "OtherGivenNameT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP17 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion OtherGivenNameT
                } // End of if PersonNameDetails node exists

                _currentXPath.Pop();
                #endregion PersonNameDetails

                #region PersonDemographicDetails
                _currentXPath.Push("/tns:PersonDemographicDetails");
                //3. use case
                if (ReadToNextElement(reader, false) && reader.LocalName == "PersonDemographicDetails")
                {
                    report.Payee_PersonDemographicDetailsCollectionExists = true;
                    report.Payee_PersonDemographicDetailsCollectionCount += 1;
                    _found = true;

                    #region BirthDm
                    _currentXPath.Push("/tns:BirthDm");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "BirthDm")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                if (Int32.TryParse(currentValue, out currentIntValue))
                                {
                                    report.PAYEVNTEMP205 = currentIntValue;
                                }
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion BirthDm

                    #region BirthM
                    _currentXPath.Push("/tns:BirthM");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "BirthM")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                if (Int32.TryParse(currentValue, out currentIntValue))
                                {
                                    report.PAYEVNTEMP203 = currentIntValue;
                                }
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion BirthM

                    #region BirthY
                    _currentXPath.Push("/tns:BirthY");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "BirthY")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                if (Int32.TryParse(currentValue, out currentIntValue))
                                {
                                    report.PAYEVNTEMP204 = currentIntValue;
                                }
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion BirthY
                } // End of if PersonDemographicDetails node exists

                _currentXPath.Pop();
                #endregion PersonDemographicDetails

                #region AddressDetails
                _currentXPath.Push("/tns:AddressDetails");
                //3. use case
                if (ReadToNextElement(reader, true) && reader.LocalName == "AddressDetails")
                {
                    report.Payee_AddressDetailsCollectionExists = true;
                    report.Payee_AddressDetailsCollectionCount += 1;
                    _found = true;

                    #region Line1T
                    _currentXPath.Push("/tns:Line1T");
                    //6. use case
                    if (ReadToNextElement(reader, true) && reader.LocalName == "Line1T")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP21 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion Line1T

                    #region Line2T
                    _currentXPath.Push("/tns:Line2T");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "Line2T")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP22 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion Line2T

                    #region LocalityNameT
                    _currentXPath.Push("/tns:LocalityNameT");
                    //6. use case
                    if (ReadToNextElement(reader, true) && reader.LocalName == "LocalityNameT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP23 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion LocalityNameT

                    #region StateOrTerritoryC
                    _currentXPath.Push("/tns:StateOrTerritoryC");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "StateOrTerritoryC")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP24 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion StateOrTerritoryC

                    #region PostcodeT
                    _currentXPath.Push("/tns:PostcodeT");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "PostcodeT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP25 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion PostcodeT

                    #region CountryC
                    _currentXPath.Push("/tns:CountryC");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "CountryC")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP27 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion CountryC
                } // End of if AddressDetails node exists

                _currentXPath.Pop();
                #endregion AddressDetails

                #region ElectronicContact
                _currentXPath.Push("/tns:ElectronicContact");
                //3. use case
                if (ReadToNextElement(reader, false) && reader.LocalName == "ElectronicContact")
                {
                    report.Payee_ElectronicContactCollectionExists = true;
                    report.Payee_ElectronicContactCollectionCount += 1;
                    _found = true;

                    #region ElectronicMailAddressT
                    _currentXPath.Push("/tns:ElectronicMailAddressT");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "ElectronicMailAddressT")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP94 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion ElectronicMailAddressT

                    #region TelephoneMinimalN
                    _currentXPath.Push("/tns:TelephoneMinimalN");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "TelephoneMinimalN")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                report.PAYEVNTEMP95 = currentValue;
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion TelephoneMinimalN
                } // End of if ElectronicContact node exists

                _currentXPath.Pop();
                #endregion ElectronicContact

                #region EmployerConditions
                _currentXPath.Push("/tns:EmployerConditions");
                //3. use case
                if (ReadToNextElement(reader, false) && reader.LocalName == "EmployerConditions")
                {
                    report.Payee_EmployerConditionsCollectionExists = true;
                    report.Payee_EmployerConditionsCollectionCount += 1;
                    _found = true;

                    #region EmploymentStartD
                    _currentXPath.Push("/tns:EmploymentStartD");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "EmploymentStartD")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                {
                                    report.PAYEVNTEMP92 = currentDateTimeValue.Date;
                                }
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion EmploymentStartD

                    #region EmploymentEndD
                    _currentXPath.Push("/tns:EmploymentEndD");
                    //6. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "EmploymentEndD")
                    {
                        if (!IsEmptyOrNilElement(reader))
                        {
                            ReadNext(reader);
                            if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                            {
                                currentValue = reader.Value;
                                ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                {
                                    report.PAYEVNTEMP93 = currentDateTimeValue.Date;
                                }
                            }
                        }
                        _found = true;
                    }

                    _currentXPath.Pop();
                    #endregion EmploymentEndD
                } // End of if EmployerConditions node exists

                _currentXPath.Pop();
                #endregion EmployerConditions

                #region RemunerationIncomeTaxPayAsYouGoWithholding
                _currentXPath.Push("/tns:RemunerationIncomeTaxPayAsYouGoWithholding");
                //3. use case
                if (ReadToNextElement(reader, false) && reader.LocalName == "RemunerationIncomeTaxPayAsYouGoWithholding")
                {
                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholdingCollectionExists = true;
                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholdingCollectionCount += 1;
                    _found = true;

                    #region PayrollPeriod
                    _currentXPath.Push("/tns:PayrollPeriod");
                    //3. use case
                    if (ReadToNextElement(reader, true) && reader.LocalName == "PayrollPeriod")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_PayrollPeriodCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_PayrollPeriodCollectionCount += 1;
                        _found = true;

                        #region StartD
                        _currentXPath.Push("/tns:StartD");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "StartD")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                    {
                                        report.PAYEVNTEMP29 = currentDateTimeValue.Date;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion StartD

                        #region EndD
                        _currentXPath.Push("/tns:EndD");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "EndD")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                    {
                                        report.PAYEVNTEMP30 = currentDateTimeValue.Date;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion EndD

                        #region PayrollEventFinalI
                        _currentXPath.Push("/tns:PayrollEventFinalI");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "PayrollEventFinalI")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    currentBooleanValue = ToBoolean(currentValue);
                                    if (currentBooleanValue != null)
                                    {
                                        report.PAYEVNTEMP110 = currentBooleanValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion PayrollEventFinalI
                    } // End of if PayrollPeriod node exists

                    _currentXPath.Pop();
                    #endregion PayrollPeriod

                    #region IndividualNonBusiness
                    _currentXPath.Push("/tns:IndividualNonBusiness");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "IndividualNonBusiness")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IndividualNonBusinessCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IndividualNonBusinessCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP47 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region CommunityDevelopmentEmploymentProjectA
                        _currentXPath.Push("/tns:CommunityDevelopmentEmploymentProjectA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "CommunityDevelopmentEmploymentProjectA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP60 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion CommunityDevelopmentEmploymentProjectA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP130 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA

                        #region ExemptForeignEmploymentIncomeA
                        _currentXPath.Push("/tns:ExemptForeignEmploymentIncomeA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "ExemptForeignEmploymentIncomeA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP49 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion ExemptForeignEmploymentIncomeA
                    } // End of if IndividualNonBusiness node exists

                    _currentXPath.Pop();
                    #endregion IndividualNonBusiness

                    #region VoluntaryAgreement
                    _currentXPath.Push("/tns:VoluntaryAgreement");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "VoluntaryAgreement")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_VoluntaryAgreementCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_VoluntaryAgreementCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP57 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP115 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if VoluntaryAgreement node exists

                    _currentXPath.Pop();
                    #endregion VoluntaryAgreement

                    #region LabourHireArrangementPayment
                    _currentXPath.Push("/tns:LabourHireArrangementPayment");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "LabourHireArrangementPayment")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_LabourHireArrangementPaymentCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_LabourHireArrangementPaymentCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP48 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP114 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if LabourHireArrangementPayment node exists

                    _currentXPath.Pop();
                    #endregion LabourHireArrangementPayment

                    #region SpecifiedByRegulationPayment
                    _currentXPath.Push("/tns:SpecifiedByRegulationPayment");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "SpecifiedByRegulationPayment")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_SpecifiedByRegulationPaymentCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_SpecifiedByRegulationPaymentCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP122 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP116 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if SpecifiedByRegulationPayment node exists

                    _currentXPath.Pop();
                    #endregion SpecifiedByRegulationPayment

                    #region JointPetroleumDevelopmentAreaPayment
                    _currentXPath.Push("/tns:JointPetroleumDevelopmentAreaPayment");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "JointPetroleumDevelopmentAreaPayment")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_JointPetroleumDevelopmentAreaPaymentCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_JointPetroleumDevelopmentAreaPaymentCollectionCount += 1;
                        _found = true;

                        #region A
                        _currentXPath.Push("/tns:A");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "A")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP120 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion A

                        #region ForeignWithholdingA
                        _currentXPath.Push("/tns:ForeignWithholdingA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "ForeignWithholdingA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP132 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion ForeignWithholdingA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP113 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if JointPetroleumDevelopmentAreaPayment node exists

                    _currentXPath.Pop();
                    #endregion JointPetroleumDevelopmentAreaPayment

                    #region WorkingHolidayMaker
                    _currentXPath.Push("/tns:WorkingHolidayMaker");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "WorkingHolidayMaker")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_WorkingHolidayMakerCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_WorkingHolidayMakerCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP200 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP201 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if WorkingHolidayMaker node exists

                    _currentXPath.Pop();
                    #endregion WorkingHolidayMaker

                    #region PaymentToForeignResident
                    _currentXPath.Push("/tns:PaymentToForeignResident");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "PaymentToForeignResident")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_PaymentToForeignResidentCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_PaymentToForeignResidentCollectionCount += 1;
                        _found = true;

                        #region GrossA
                        _currentXPath.Push("/tns:GrossA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "GrossA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP119 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion GrossA

                        #region ForeignWithholdingA
                        _currentXPath.Push("/tns:ForeignWithholdingA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "ForeignWithholdingA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP237 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion ForeignWithholdingA

                        #region TaxWithheldA
                        _currentXPath.Push("/tns:TaxWithheldA");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP112 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxWithheldA
                    } // End of if PaymentToForeignResident node exists

                    _currentXPath.Pop();
                    #endregion PaymentToForeignResident

                    #region EmploymentTerminationPayment

                    _currentXPath.Push("/tns:EmploymentTerminationPaymentCollection");
                    // 4. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "EmploymentTerminationPaymentCollection")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollection = new List<PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPayment>();
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollectionExists = true;

                        _found = true;

                        while (ReadToNextElement(reader, false) && reader.LocalName == "EmploymentTerminationPayment")
                        {
                            _found = true;

                            PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPayment employmentTerminationPayment = new PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPayment();
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollection.Add(employmentTerminationPayment);
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollectionCount += 1;
                            employmentTerminationPayment.OccurrenceIndex = report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollectionCount;

                            _currentXPath.Push("/tns:EmploymentTerminationPayment[" + report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_EmploymentTerminationPaymentCollectionCount + "]");

                            #region TypeC
                            _currentXPath.Push("/tns:TypeC");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "TypeC")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        employmentTerminationPayment.PAYEVNTEMP34 = currentValue;
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion TypeC

                            #region PaymentRecordPaymentEffectiveD
                            _currentXPath.Push("/tns:PaymentRecordPaymentEffectiveD");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "PaymentRecordPaymentEffectiveD")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                        {
                                            employmentTerminationPayment.PAYEVNTEMP123 = currentDateTimeValue.Date;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion PaymentRecordPaymentEffectiveD

                            #region SuperannuationTaxFreeComponentA
                            _currentXPath.Push("/tns:SuperannuationTaxFreeComponentA");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "SuperannuationTaxFreeComponentA")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            employmentTerminationPayment.PAYEVNTEMP50 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion SuperannuationTaxFreeComponentA

                            #region SuperannuationEmploymentTerminationTaxableComponentTotalA
                            _currentXPath.Push("/tns:SuperannuationEmploymentTerminationTaxableComponentTotalA");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "SuperannuationEmploymentTerminationTaxableComponentTotalA")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            employmentTerminationPayment.PAYEVNTEMP51 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion SuperannuationEmploymentTerminationTaxableComponentTotalA

                            #region TaxWithheldA
                            _currentXPath.Push("/tns:TaxWithheldA");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "TaxWithheldA")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            employmentTerminationPayment.PAYEVNTEMP117 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion TaxWithheldA
                            _currentXPath.Pop();
                        } // End of while loop for EmploymentTerminationPayment
                    } // End of if EmploymentTerminationPaymentCollection node exists

                    _currentXPath.Pop();
                    #endregion EmploymentTerminationPayment

                    #region UnusedAnnualOrLongServiceLeavePayment
                    _currentXPath.Push("/tns:UnusedAnnualOrLongServiceLeavePayment");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "UnusedAnnualOrLongServiceLeavePayment")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_UnusedAnnualOrLongServiceLeavePaymentCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_UnusedAnnualOrLongServiceLeavePaymentCollectionCount += 1;
                        _found = true;

                        #region LumpSumPaymentA
                        _currentXPath.Push("/tns:LumpSumPaymentA");
                        //3. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "LumpSumPaymentA")
                        {
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_UnusedAnnualOrLongServiceLeavePayment_LumpSumPaymentACollectionExists = true;
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_UnusedAnnualOrLongServiceLeavePayment_LumpSumPaymentACollectionCount += 1;
                            _found = true;

                            #region LumpSumAC
                            _currentXPath.Push("/tns:LumpSumAC");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "LumpSumAC")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        report.PAYEVNTEMP53 = currentValue;
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion LumpSumAC

                            #region LumpSumAA
                            _currentXPath.Push("/tns:LumpSumAA");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "LumpSumAA")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            report.PAYEVNTEMP52 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion LumpSumAA
                        } // End of if LumpSumPaymentA node exists

                        _currentXPath.Pop();
                        #endregion LumpSumPaymentA

                        #region LumpSumBA
                        _currentXPath.Push("/tns:LumpSumBA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "LumpSumBA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP54 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion LumpSumBA

                        #region LumpSumDA
                        _currentXPath.Push("/tns:LumpSumDA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "LumpSumDA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP55 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion LumpSumDA

                        #region LumpSumEA
                        _currentXPath.Push("/tns:LumpSumEA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "LumpSumEA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP56 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion LumpSumEA
                    } // End of if UnusedAnnualOrLongServiceLeavePayment node exists

                    _currentXPath.Pop();
                    #endregion UnusedAnnualOrLongServiceLeavePayment

                    #region Allowance

                    _currentXPath.Push("/tns:AllowanceCollection");
                    // 4. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "AllowanceCollection")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollection = new List<PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Allowance>();
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollectionExists = true;

                        _found = true;

                        while (ReadToNextElement(reader, false) && reader.LocalName == "Allowance")
                        {
                            _found = true;

                            PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Allowance allowance = new PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Allowance();
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollection.Add(allowance);
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollectionCount += 1;
                            allowance.OccurrenceIndex = report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollectionCount;

                            _currentXPath.Push("/tns:Allowance[" + report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_AllowanceCollectionCount + "]");

                            #region TypeC
                            _currentXPath.Push("/tns:TypeC");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "TypeC")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        allowance.PAYEVNTEMP7 = currentValue;
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion TypeC

                            #region OtherAllowanceTypeDe
                            _currentXPath.Push("/tns:OtherAllowanceTypeDe");
                            //6. use case
                            if (ReadToNextElement(reader, false) && reader.LocalName == "OtherAllowanceTypeDe")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        allowance.PAYEVNTEMP8 = currentValue;
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion OtherAllowanceTypeDe

                            #region IndividualNonBusinessEmploymentAllowancesA
                            _currentXPath.Push("/tns:IndividualNonBusinessEmploymentAllowancesA");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "IndividualNonBusinessEmploymentAllowancesA")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            allowance.PAYEVNTEMP62 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion IndividualNonBusinessEmploymentAllowancesA
                            _currentXPath.Pop();
                        } // End of while loop for Allowance
                    } // End of if AllowanceCollection node exists

                    _currentXPath.Pop();
                    #endregion Allowance

                    #region Deduction

                    _currentXPath.Push("/tns:DeductionCollection");
                    // 4. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "DeductionCollection")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollection = new List<PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Deduction>();
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollectionExists = true;

                        _found = true;

                        while (ReadToNextElement(reader, false) && reader.LocalName == "Deduction")
                        {
                            _found = true;

                            PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Deduction deduction = new PAYEVNTEMP2018.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_Deduction();
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollection.Add(deduction);
                            report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollectionCount += 1;
                            deduction.OccurrenceIndex = report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollectionCount;

                            _currentXPath.Push("/tns:Deduction[" + report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_DeductionCollectionCount + "]");

                            #region TypeC
                            _currentXPath.Push("/tns:TypeC");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "TypeC")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        deduction.PAYEVNTEMP10 = currentValue;
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion TypeC

                            #region A
                            _currentXPath.Push("/tns:A");
                            //6. use case
                            if (ReadToNextElement(reader, true) && reader.LocalName == "A")
                            {
                                if (!IsEmptyOrNilElement(reader))
                                {
                                    ReadNext(reader);
                                    if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                    {
                                        currentValue = reader.Value;
                                        ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                        if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                        {
                                            deduction.PAYEVNTEMP87 = currentDecimalValue;
                                        }
                                    }
                                }
                                _found = true;
                            }

                            _currentXPath.Pop();
                            #endregion A
                            _currentXPath.Pop();
                        } // End of while loop for Deduction
                    } // End of if DeductionCollection node exists

                    _currentXPath.Pop();
                    #endregion Deduction

                    #region SuperannuationContribution
                    _currentXPath.Push("/tns:SuperannuationContribution");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "SuperannuationContribution")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_SuperannuationContributionCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_SuperannuationContributionCollectionCount += 1;
                        _found = true;

                        #region EmployerContributionsSuperannuationGuaranteeA
                        _currentXPath.Push("/tns:EmployerContributionsSuperannuationGuaranteeA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "EmployerContributionsSuperannuationGuaranteeA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP84 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion EmployerContributionsSuperannuationGuaranteeA

                        #region OrdinaryTimeEarningsA
                        _currentXPath.Push("/tns:OrdinaryTimeEarningsA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "OrdinaryTimeEarningsA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP61 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion OrdinaryTimeEarningsA

                        #region EmployerReportableA
                        _currentXPath.Push("/tns:EmployerReportableA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "EmployerReportableA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP111 = currentDecimalValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion EmployerReportableA
                    } // End of if SuperannuationContribution node exists

                    _currentXPath.Pop();
                    #endregion SuperannuationContribution

                    #region IncomeFringeBenefitsReportable
                    _currentXPath.Push("/tns:IncomeFringeBenefitsReportable");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "IncomeFringeBenefitsReportable")
                    {
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportableCollectionExists = true;
                        report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportableCollectionCount += 1;
                        _found = true;

                        #region TaxableIncomeFringeBenefitsReportableA
                        _currentXPath.Push("/tns:TaxableIncomeFringeBenefitsReportableA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "TaxableIncomeFringeBenefitsReportableA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP125 = currentDecimalValue;
                                    }
                                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportable_TaxableCollectionExists = true;
                                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportable_TaxableCollectionCount += 1;
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxableIncomeFringeBenefitsReportableA

                        #region ExemptIncomeFringeBenefitsReportableA
                        _currentXPath.Push("/tns:ExemptIncomeFringeBenefitsReportableA");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "ExemptIncomeFringeBenefitsReportableA")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (Decimal.TryParse(currentValue, out currentDecimalValue))
                                    {
                                        report.PAYEVNTEMP126 = currentDecimalValue;
                                    }
                                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportable_ExemptCollectionExists = true;
                                    report.Payee_RemunerationIncomeTaxPayAsYouGoWithholding_IncomeFringeBenefitsReportable_ExemptCollectionCount += 1;
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion ExemptIncomeFringeBenefitsReportableA
                    } // End of if IncomeFringeBenefitsReportable node exists

                    _currentXPath.Pop();
                    #endregion IncomeFringeBenefitsReportable
                } // End of if RemunerationIncomeTaxPayAsYouGoWithholding node exists

                _currentXPath.Pop();
                #endregion RemunerationIncomeTaxPayAsYouGoWithholding

                #region Onboarding
                _currentXPath.Push("/tns:Onboarding");
                //3. use case
                if (ReadToNextElement(reader, false) && reader.LocalName == "Onboarding")
                {
                    report.Payee_OnboardingCollectionExists = true;
                    report.Payee_OnboardingCollectionCount += 1;
                    _found = true;

                    #region TFND
                    _currentXPath.Push("/tns:TFND");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "TFND")
                    {
                        report.Payee_Onboarding_TFNDCollectionExists = true;
                        report.Payee_Onboarding_TFNDCollectionCount += 1;
                        _found = true;

                        #region PaymentArrangementTerminationC
                        _currentXPath.Push("/tns:PaymentArrangementTerminationC");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "PaymentArrangementTerminationC")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    report.PAYEVNTEMP238 = currentValue;
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion PaymentArrangementTerminationC

                        #region ResidencyTaxPurposesPersonStatusC
                        _currentXPath.Push("/tns:ResidencyTaxPurposesPersonStatusC");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "ResidencyTaxPurposesPersonStatusC")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    report.PAYEVNTEMP202 = currentValue;
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion ResidencyTaxPurposesPersonStatusC

                        #region PaymentArrangementPaymentBasisC
                        _currentXPath.Push("/tns:PaymentArrangementPaymentBasisC");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "PaymentArrangementPaymentBasisC")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    report.PAYEVNTEMP96 = currentValue;
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion PaymentArrangementPaymentBasisC

                        #region TaxOffsetClaimTaxFreeThresholdI
                        _currentXPath.Push("/tns:TaxOffsetClaimTaxFreeThresholdI");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "TaxOffsetClaimTaxFreeThresholdI")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    currentBooleanValue = ToBoolean(currentValue);
                                    if (currentBooleanValue != null)
                                    {
                                        report.PAYEVNTEMP98 = currentBooleanValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion TaxOffsetClaimTaxFreeThresholdI

                        #region IncomeTaxPayAsYouGoWithholdingStudyAndTrainingLoanRepaymentI
                        _currentXPath.Push("/tns:IncomeTaxPayAsYouGoWithholdingStudyAndTrainingLoanRepaymentI");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "IncomeTaxPayAsYouGoWithholdingStudyAndTrainingLoanRepaymentI")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    currentBooleanValue = ToBoolean(currentValue);
                                    if (currentBooleanValue != null)
                                    {
                                        report.PAYEVNTEMP241 = currentBooleanValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion IncomeTaxPayAsYouGoWithholdingStudyAndTrainingLoanRepaymentI

                        #region StudentLoanStudentFinancialSupplementSchemeI
                        _currentXPath.Push("/tns:StudentLoanStudentFinancialSupplementSchemeI");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "StudentLoanStudentFinancialSupplementSchemeI")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    currentBooleanValue = ToBoolean(currentValue);
                                    if (currentBooleanValue != null)
                                    {
                                        report.PAYEVNTEMP106 = currentBooleanValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion StudentLoanStudentFinancialSupplementSchemeI
                    } // End of if TFND node exists

                    _currentXPath.Pop();
                    #endregion TFND

                    #region Declaration
                    _currentXPath.Push("/tns:Declaration");
                    //3. use case
                    if (ReadToNextElement(reader, false) && reader.LocalName == "Declaration")
                    {
                        report.Payee_Onboarding_DeclarationCollectionExists = true;
                        report.Payee_Onboarding_DeclarationCollectionCount += 1;
                        _found = true;

                        #region StatementAcceptedI
                        _currentXPath.Push("/tns:StatementAcceptedI");
                        //6. use case
                        if (ReadToNextElement(reader, true) && reader.LocalName == "StatementAcceptedI")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    currentBooleanValue = ToBoolean(currentValue);
                                    if (currentBooleanValue != null)
                                    {
                                        report.PAYEVNTEMP129 = currentBooleanValue;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion StatementAcceptedI

                        #region SignatureD
                        _currentXPath.Push("/tns:SignatureD");
                        //6. use case
                        if (ReadToNextElement(reader, false) && reader.LocalName == "SignatureD")
                        {
                            if (!IsEmptyOrNilElement(reader))
                            {
                                ReadNext(reader);
                                if (reader.NodeType == XmlNodeType.Text || reader.NodeType == XmlNodeType.CDATA)
                                {
                                    currentValue = reader.Value;
                                    ReadNext(reader); // consume the end element so we detect any validation errors before _currentXPath is updated.
                                    if (DateTime.TryParse(currentValue, out currentDateTimeValue))
                                    {
                                        report.PAYEVNTEMP128 = currentDateTimeValue.Date;
                                    }
                                }
                            }
                            _found = true;
                        }

                        _currentXPath.Pop();
                        #endregion SignatureD
                    } // End of if Declaration node exists

                    _currentXPath.Pop();
                    #endregion Declaration
                } // End of if Onboarding node exists

                _currentXPath.Pop();
                #endregion Onboarding
            } // End of if Payee node exists

            _currentXPath.Pop();
            //to check schema through the end
            while (!reader.EOF)
            {
                reader.Read();
            }
            #endregion Payee
            return report;
        }

        private string _elementCsvList = "TaxFileNumberId,AustralianBusinessNumberId,EmploymentPayrollNumberId,Identifiers,FamilyNameT,GivenNameT,OtherGivenNameT,PersonNameDetails,BirthDm,BirthM,BirthY,PersonDemographicDetails,Line1T,Line2T,LocalityNameT,StateOrTerritoryC,PostcodeT,CountryC,AddressDetails,ElectronicMailAddressT,TelephoneMinimalN,ElectronicContact,EmploymentStartD,EmploymentEndD,EmployerConditions,StartD,EndD,PayrollEventFinalI,PayrollPeriod,GrossA,CommunityDevelopmentEmploymentProjectA,TaxWithheldA,ExemptForeignEmploymentIncomeA,IndividualNonBusiness,GrossA,TaxWithheldA,VoluntaryAgreement,GrossA,TaxWithheldA,LabourHireArrangementPayment,GrossA,TaxWithheldA,SpecifiedByRegulationPayment,A,ForeignWithholdingA,TaxWithheldA,JointPetroleumDevelopmentAreaPayment,GrossA,TaxWithheldA,WorkingHolidayMaker,GrossA,ForeignWithholdingA,TaxWithheldA,PaymentToForeignResident,TypeC,PaymentRecordPaymentEffectiveD,SuperannuationTaxFreeComponentA,SuperannuationEmploymentTerminationTaxableComponentTotalA,TaxWithheldA,EmploymentTerminationPaymentCollection,LumpSumAC,LumpSumAA,LumpSumPaymentA,LumpSumBA,LumpSumDA,LumpSumEA,UnusedAnnualOrLongServiceLeavePayment,TypeC,OtherAllowanceTypeDe,IndividualNonBusinessEmploymentAllowancesA,AllowanceCollection,TypeC,A,DeductionCollection,EmployerContributionsSuperannuationGuaranteeA,OrdinaryTimeEarningsA,EmployerReportableA,SuperannuationContribution,TaxableIncomeFringeBenefitsReportableA,ExemptIncomeFringeBenefitsReportableA,IncomeFringeBenefitsReportable,RemunerationIncomeTaxPayAsYouGoWithholding,PaymentArrangementTerminationC,ResidencyTaxPurposesPersonStatusC,PaymentArrangementPaymentBasisC,TaxOffsetClaimTaxFreeThresholdI,IncomeTaxPayAsYouGoWithholdingStudyAndTrainingLoanRepaymentI,StudentLoanStudentFinancialSupplementSchemeI,TFND,StatementAcceptedI,SignatureD,Declaration,Onboarding,Payee";

    }
}

